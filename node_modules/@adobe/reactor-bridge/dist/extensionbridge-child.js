/***************************************************************************************
 * (c) 2017 Adobe. All rights reserved.
 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License. You may obtain a copy
 * of the License at http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
 * OF ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 ****************************************************************************************/

!function(e){function n(o){if(t[o])return t[o].exports;var r=t[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}var t={};return n.m=e,n.c=t,n.p="",n(0)}([function(e,n,t){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}var r=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=t(1),c=o(a),u=t(2),s=o(u),l=t(6),f=o(l),d=t(7),p=o(d),m="\n  html, body {\n    background-color: transparent !important;\n  }\n";(0,p.default)(m),c.default.Promise=s.default;var h=new f.default("ExtensionBridge:Child"),v={},g={},y=function(e){var n=v[e];if(n)return n.bind(v);throw new Error("Unable to call "+e+" on the extension. The extension must register a "+e+" function using extensionBridge.register().")},w=function(){y("init").apply(void 0,arguments)},b=function(){var e=y("validate").apply(void 0,arguments);if("boolean"!=typeof e)throw new Error("The extension attempted to return a non-boolean value from validate: "+e);return e},_=function(){var e=y("getSettings").apply(void 0,arguments);if("object"!==("undefined"==typeof e?"undefined":i(e)))throw new Error("The extension attempted to return a non-object value from getSettings: "+e);return e},T=function(e,n){return function(){for(var t=arguments.length,o=Array(t),r=0;r<t;r++)o[r]=arguments[r];if(!g[e])throw new Error("An error occurred while opening "+n+". The shared view is unavailable.");if("function"!=typeof o[0]){console.warn("Your usage of "+e+" has been deprecated and support will be removed before Launch is released. Please refer to https://git.corp.adobe.com/reactor/propaganda/blob/master/guides/extensions/views.md#leveraging-shared-views for current method signature documentation.");var i=o.pop();if(!i)throw new Error("A callback is required when opening a shared view.");switch(e){case"openCodeEditor":g.openCodeEditor({code:o[0]}).then(i);break;case"openRegexTester":g.openRegexTester({regex:o[0]}).then(i)}}else{var a,c=o.shift();if(!c)throw new Error("A callback is required when opening a shared view.");(a=g)[e].apply(a,o).then(c)}}};c.default.connectToParent({methods:{init:w,validate:b,getSettings:_}}).promise.then(function(e){g=e});for(var E={openCodeEditor:T("openCodeEditor","code editor"),openDataElementSelector:T("openDataElementSelector","data element selector"),openCssSelector:T("openCssSelector","CSS selector"),openRegexTester:T("openRegexTester","regex tester"),register:function(e){v=r({},e),h.log("Methods registered by extension.")},setDebug:function(e){c.default.debug=e,f.default.enabled=e}},P=function(e){E[e.methodName].apply(null,e.args)},x=window.extensionBridge._callQueue;x.length;)P(x.shift());x.push=P},function(e,n){"use strict";function t(e){if(Array.isArray(e)){for(var n=0,t=Array(e.length);n<e.length;n++)t[n]=e[n];return t}return Array.from(e)}Object.defineProperty(n,"__esModule",{value:!0});var o="parent",r="child",i="handshake",a="handshake-reply",c="call",u="reply",s="fulfilled",l="rejected",f="message",d="load",p={Promise:function(){try{return window?window.Promise:null}catch(e){return null}}(),debug:!1},m=function(){var e=0;return function(){return++e}}(),h=function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];if(p.debug){var o;(o=console).log.apply(o,["[Penpal]"].concat(n))}},v=function(e){var n=document.location,t=document.createElement("a");return t.href=e,t.origin||(t.protocol||n.protocol)+"//"+(t.hostname||n.hostname)+":"+(t.port||n.port)},g=function(e){var n=[];return e(function(){n.forEach(function(e){e()})}),{then:function(e){n.push(e)}}},y=function(e,n,t){var o=e.localName,r=e.local,i=e.remote,a=e.remoteOrigin,l=!1;h(o+": Creating call sender");var d=function(e){return function(){for(var n=arguments.length,t=Array(n),d=0;d<n;d++)t[d]=arguments[d];return h(o+": Sending "+e+"() call"),new p.Promise(function(n,d){if(l)return void d("Unable to send "+e+"() call due to destroyed connection");var p=m(),v=function t(c){c.source===i&&c.origin===a&&c.data.penpal===u&&c.data.id===p&&(h(o+": Received "+e+"() reply"),r.removeEventListener(f,t),(c.data.resolution===s?n:d)(c.data.returnValue))};r.addEventListener(f,v),i.postMessage({penpal:c,id:p,methodName:e,args:t},a)})}};return t.then(function(){l=!0}),n.reduce(function(e,n){return e[n]=d(n),e},{})},w=function(e,n,o){var r=e.localName,i=e.local,a=e.remote,d=e.remoteOrigin,m=!1;h(r+": Connecting call receiver");var v=function(e){e.source===a&&e.origin===d&&e.data.penpal===c&&!function(){var o=e.data,i=o.methodName,c=o.args,f=o.id;if(h(r+": Received "+i+"() call"),i in n){var v=function(e){return function(n){return m?void setTimeout(function(){throw new Error("Unable to send "+i+"() reply due to destroyed connection")}):(h(r+": Sending "+i+"() reply"),void a.postMessage({penpal:u,id:f,resolution:e,returnValue:n},d))}};new p.Promise(function(e,o){try{e(n[i].apply(n,t(c)))}catch(e){o(e.toString()),setTimeout(function(){throw e})}}).then(v(s),v(l))}}()};i.addEventListener(f,v),o.then(function(){m=!0,i.removeEventListener(f,v)})};p.connectToChild=function(e){var n=e.url,t=e.appendTo,r=e.methods,c=void 0===r?{}:r,u=void 0,s=new g(function(e){return u=e}),l=window,m=document.createElement("iframe");(t||document.body).appendChild(m),s.then(function(){m.parentNode&&m.parentNode.removeChild(m)});var b=m.contentWindow||m.contentDocument.parentWindow,_=v(n),T=new p.Promise(function(e,t){var r=function n(t){if(t.source===b&&t.origin===_&&t.data.penpal===a){h("Parent: Received handshake reply from Child"),l.removeEventListener(f,n);var r={localName:o,local:l,remote:b,remoteOrigin:t.origin};w(r,c,s),e(y(r,t.data.methodNames,s))}},u=function(){h("Parent: Sending handshake"),l.addEventListener(f,r),s.then(function(){l.removeEventListener(f,r)}),b.postMessage({penpal:i,methodNames:Object.keys(c)},_)};m.addEventListener(d,u),s.then(function(){m.removeEventListener(d,u),t("Parent: Connection destroyed")}),h("Parent: Loading iframe"),m.src=n});return{promise:T,iframe:m,destroy:u}},p.connectToParent=function(e){var n=e.parentOrigin,t=e.methods,o=void 0===t?{}:t,c=void 0,u=new g(function(e){return c=e}),s=window,l=s.parent,d=new p.Promise(function(e,t){var c=function t(c){if((!n||c.origin===n)&&c.data.penpal===i){h("Child: Received handshake from Parent"),s.removeEventListener(f,t),h("Child: Sending handshake reply to Parent"),c.source.postMessage({penpal:a,methodNames:Object.keys(o)},c.origin);var d={localName:r,local:s,remote:l,remoteOrigin:c.origin};w(d,o,u),e(y(d,c.data.methodNames,u))}};s.addEventListener(f,c),u.then(function(){s.removeEventListener(f,c),t("Child: Connection destroyed")})});return{promise:d,destroy:c}},n.default=p},function(e,n,t){(function(n){!function(t){function o(){}function r(e,n){return function(){e.apply(n,arguments)}}function i(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(e,this)}function a(e,n){for(;3===e._state;)e=e._value;return 0===e._state?void e._deferreds.push(n):(e._handled=!0,void i._immediateFn(function(){var t=1===e._state?n.onFulfilled:n.onRejected;if(null===t)return void(1===e._state?c:u)(n.promise,e._value);var o;try{o=t(e._value)}catch(e){return void u(n.promise,e)}c(n.promise,o)}))}function c(e,n){try{if(n===e)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var t=n.then;if(n instanceof i)return e._state=3,e._value=n,void s(e);if("function"==typeof t)return void f(r(t,n),e)}e._state=1,e._value=n,s(e)}catch(n){u(e,n)}}function u(e,n){e._state=2,e._value=n,s(e)}function s(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var n=0,t=e._deferreds.length;n<t;n++)a(e,e._deferreds[n]);e._deferreds=null}function l(e,n,t){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof n?n:null,this.promise=t}function f(e,n){var t=!1;try{e(function(e){t||(t=!0,c(n,e))},function(e){t||(t=!0,u(n,e))})}catch(e){if(t)return;t=!0,u(n,e)}}var d=setTimeout;i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,n){var t=new this.constructor(o);return a(this,new l(e,n,t)),t},i.all=function(e){var n=Array.prototype.slice.call(e);return new i(function(e,t){function o(i,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var c=a.then;if("function"==typeof c)return void c.call(a,function(e){o(i,e)},t)}n[i]=a,0===--r&&e(n)}catch(e){t(e)}}if(0===n.length)return e([]);for(var r=n.length,i=0;i<n.length;i++)o(i,n[i])})},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i(function(n){n(e)})},i.reject=function(e){return new i(function(n,t){t(e)})},i.race=function(e){return new i(function(n,t){for(var o=0,r=e.length;o<r;o++)e[o].then(n,t)})},i._immediateFn="function"==typeof n&&function(e){n(e)}||function(e){d(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},i._setImmediateFn=function(e){i._immediateFn=e},i._setUnhandledRejectionFn=function(e){i._unhandledRejectionFn=e},"undefined"!=typeof e&&e.exports?e.exports=i:t.Promise||(t.Promise=i)}(this)}).call(n,t(3).setImmediate)},function(e,n,t){function o(e,n){this._id=e,this._clearFn=n}var r=Function.prototype.apply;n.setTimeout=function(){return new o(r.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new o(r.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(e,n){clearTimeout(e._idleTimeoutId),e._idleTimeout=n},n.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},n._unrefActive=n.active=function(e){clearTimeout(e._idleTimeoutId);var n=e._idleTimeout;n>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},n))},t(4),n.setImmediate=setImmediate,n.clearImmediate=clearImmediate},function(e,n,t){(function(e,n){!function(e,t){"use strict";function o(e){"function"!=typeof e&&(e=new Function(""+e));for(var n=new Array(arguments.length-1),t=0;t<n.length;t++)n[t]=arguments[t+1];var o={callback:e,args:n};return h[m]=o,p(m),m++}function r(e){delete h[e]}function i(e){var n=e.callback,o=e.args;switch(o.length){case 0:n();break;case 1:n(o[0]);break;case 2:n(o[0],o[1]);break;case 3:n(o[0],o[1],o[2]);break;default:n.apply(t,o)}}function a(e){if(v)setTimeout(a,0,e);else{var n=h[e];if(n){v=!0;try{i(n)}finally{r(e),v=!1}}}}function c(){p=function(e){n.nextTick(function(){a(e)})}}function u(){if(e.postMessage&&!e.importScripts){var n=!0,t=e.onmessage;return e.onmessage=function(){n=!1},e.postMessage("","*"),e.onmessage=t,n}}function s(){var n="setImmediate$"+Math.random()+"$",t=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(n)&&a(+t.data.slice(n.length))};e.addEventListener?e.addEventListener("message",t,!1):e.attachEvent("onmessage",t),p=function(t){e.postMessage(n+t,"*")}}function l(){var e=new MessageChannel;e.port1.onmessage=function(e){var n=e.data;a(n)},p=function(n){e.port2.postMessage(n)}}function f(){var e=g.documentElement;p=function(n){var t=g.createElement("script");t.onreadystatechange=function(){a(n),t.onreadystatechange=null,e.removeChild(t),t=null},e.appendChild(t)}}function d(){p=function(e){setTimeout(a,0,e)}}if(!e.setImmediate){var p,m=1,h={},v=!1,g=e.document,y=Object.getPrototypeOf&&Object.getPrototypeOf(e);y=y&&y.setTimeout?y:e,"[object process]"==={}.toString.call(e.process)?c():u()?s():e.MessageChannel?l():g&&"onreadystatechange"in g.createElement("script")?f():d(),y.setImmediate=o,y.clearImmediate=r}}("undefined"==typeof self?"undefined"==typeof e?this:e:self)}).call(n,function(){return this}(),t(5))},function(e,n){function t(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function r(e){if(l===setTimeout)return setTimeout(e,0);if((l===t||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(n){try{return l.call(null,e,0)}catch(n){return l.call(this,e,0)}}}function i(e){if(f===clearTimeout)return clearTimeout(e);if((f===o||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(n){try{return f.call(null,e)}catch(n){return f.call(this,e)}}}function a(){h&&p&&(h=!1,p.length?m=p.concat(m):v=-1,m.length&&c())}function c(){if(!h){var e=r(a);h=!0;for(var n=m.length;n;){for(p=m,m=[];++v<n;)p&&p[v].run();v=-1,n=m.length}p=null,h=!1,i(e)}}function u(e,n){this.fun=e,this.array=n}function s(){}var l,f,d=e.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:t}catch(e){l=t}try{f="function"==typeof clearTimeout?clearTimeout:o}catch(e){f=o}}();var p,m=[],h=!1,v=-1;d.nextTick=function(e){var n=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)n[t-1]=arguments[t];m.push(new u(e,n)),1!==m.length||h||r(c)},u.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=s,d.addListener=s,d.once=s,d.off=s,d.removeListener=s,d.removeAllListeners=s,d.emit=s,d.binding=function(e){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(e){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},function(e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=function(e){this.moduleName=e};["log","info","warn","error"].forEach(function(e){t.prototype[e]=function(){if(t.enabled){for(var n,o=arguments.length,r=Array(o),i=0;i<o;i++)r[i]=arguments[i];(n=console)[e].apply(n,["["+this.moduleName+"]"].concat(r))}}}),t.enabled=!1,n.default=t},function(e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){var n=document.createElement("style");n.appendChild(document.createTextNode(e)),document.head.appendChild(n)}}]);